<template>
    <section class="explore">
        <FilterCategory @filterBy="onFilterBy" />

        <h3 v-if="stays.length">Found {{ stayNumber }} home<span v-if="stays.length > 1">s</span></h3>
        <h3 v-else>No results found for this search.</h3>

        <StayList :stays="stays" />
    </section>
</template>

<script>
import FilterCategory from '../cmps/FilterCategory.vue';
import StayList from '../cmps/StayList.vue';


export default {
    name: '',
    data() {
        return {
            filterBy: {},
            // stays: null
        }
    },
    methods: {
        // filterBy(filterBy) {
        //     console.log('Selected category:', filterBy)
        //     this.$store.dispatch({ type: 'loadStays', filterBy })
        // },
        onFilterBy(filter) {
            console.log('filterrrr');
            console.log('Selected category:', filter)
            this.$store.dispatch({ type: 'loadStays', filterBy: filter })
        }
    },
    computed: {
        stays() {
            return this.$store.getters.stays
        },
        stayNumber() {
            if (this.stays)
                return new Intl.NumberFormat().format(this.stays.length)
        }
    },
    created() {
        this.filterBy = {...this.$route.query}
        console.log('this.filterBy', this.filterBy)
        if (this.filterBy.from) delete this.filterBy.from
        if (this.filterBy.to) delete this.filterBy.to
        console.log('this.filterBy', this.filterBy)
        this.$store.dispatch({ type: 'loadStays', filterBy: this.filterBy })
    },
    components: {
        FilterCategory,
        StayList
    },
}
</script>